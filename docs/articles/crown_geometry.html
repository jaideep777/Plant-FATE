<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Plant-FATE">
<title>Crown geometry • Plant-FATE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Crown geometry">
<meta property="og:description" content="Plant-FATE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Plant-FATE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
    Home
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--theory">
    <span class="fa fa-book fa-lg"></span>
     
    Theory
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--theory">
    <a class="dropdown-item" href="../articles/theory_allometry.html">Allometric relations</a>
    <a class="dropdown-item" href="../articles/crown_geometry.html">Crown shape model</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../html/index.html">
    <span class="fa fa-code fa-lg"></span>
     
    API
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../articles/news.html">
    <span class="fa fa-newspaper fa-lg"></span>
     
    News
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jaideep777/Plant-FATE">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Crown geometry</h1>
                        <h4 data-toc-skip class="author">Jaideep
Joshi</h4>
            
            <h4 data-toc-skip class="date">27 February 2022</h4>
      
      
      <div class="d-none name"><code>crown_geometry.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="crown-shape">Crown shape<a class="anchor" aria-label="anchor" href="#crown-shape"></a>
</h2>
<!-- ![](media/image1.png){width="1.851496062992126in" -->
<!-- height="3.748022747156605in"} -->
<p>We need a model of crown shape that is tractable enough to yield
closed-form expressions for leaf area and sapwood mass, and realistic
enough to represent a wide variety of observed crown shapes. To do so,
we make two assumptions about the distribution of leaves through the
crown (see Fig. 1):</p>
<ol style="list-style-type: decimal">
<li><p>Leaves are concentrated near the surface of the shell generated
by the 3D crown shape, i.e., the shell thickness is much smaller than
the crown surface area. Leaves in real crowns can be distributed
substantially deeper from the shell surface, and self-shading within the
crown can be significant. To account for realistic levels of
self-shading without loss of simplicity, we define a crown leaf area
index <span class="math inline">\(L\)</span>. This implies that within
the shell thickness, there can be multiple leaf layers characteristic of
deep crowns in real forests.</p></li>
<li><p>To maximize light interception, the crown fills the entire
projected area <span class="math inline">\(A_{\text{c}}\)</span>, but
sections of the crown avoid vertical overlap even when they are located
at the same radial distance, by occupying distinct angular positions.
This also implies that the upper crown layers have gaps that are filled
by lower crown layers.</p></li>
</ol>
<p>Crown radius at height <span class="math inline">\(z\)</span> is
given by</p>
<table class="table"><tbody><tr class="odd">
<td align="center">
<span class="math display">\[r(z) = r_{0}q(z) =
r_{0}mn\left( \frac{z}{H} \right)^{n - 1}\left( 1 - \left( \frac{z}{H}
\right)^{n} \right)^{m - 1}\]</span> <span class="math inline">\(4\)</span>
</td>
</tr></tbody></table>
<hr>
<p>This function can simulate a wide diversity of crown shapes (Fig.
2).</p>
<p>The maximum of <span class="math inline">\(r(z)\)</span> occurs at a
height <span class="math inline">\(z_{\text{m}}\)</span>, which can be
obtained by solving</p>
<p><span class="math display">\[\frac{dr(z)}{dz} = - r_{0}Hmn\left(
\frac{1}{z^{2}} \right)\left( \frac{z}{H} \right)^{n}\left( 1 - \left(
\frac{z}{H} \right)^{n} \right)^{m - 2}\left( (mn - 1)\left( \frac{z}{H}
\right)^{n} - (n - 1) \right) = 0,\]</span></p>
<p>which gives</p>
<table class="table"><tbody><tr class="odd">
<td align="center">
<span class="math display">\[z_{\text{m}} = H\left(
\frac{n - 1}{mn - 1} \right)^{\frac{1}{n}}.\]</span> <span class="math inline">\(5\)</span>
</td>
</tr></tbody></table>
<hr>
<p>and</p>
<table class="table"><tbody><tr class="odd">
<td align="center">
<span class="math display">\[q_{\text{m}} = q\left(
z_{\text{m}} \right) = mn\left( \frac{n - 1}{mn - 1} \right)^{1 -
\frac{1}{n}}\left( \frac{(m - 1)n}{mn - 1} \right)^{m - 1}.\]</span>
<span class="math inline">\(6\)</span>
</td>
</tr></tbody></table>
<hr>
<p>The maximum crown projection area is</p>
<p><span class="math display">\[A_{c} = \pi r^{2}\left( z_{\text{m}}
\right) = {\pi\left( r_{0}q\left( z_{\text{m}} \right)
\right)}^{2},\]</span></p>
<p>giving</p>
<table class="table"><tbody><tr class="odd">
<td align="center">
<span class="math display">\[r_{0} =
\frac{1}{q_{\text{m}}}\sqrt{\frac{A_{c}}{\pi}}.\]</span> <span class="math inline">\(7\)</span>
</td>
</tr></tbody></table>
<hr>
<div class="figure">
<img src="crown_geometry_files/figure-html/crown_shapes-1.png" alt="\label{fig:crown_shapes} Crown shapes for different values of m and n" width="432"><p class="caption">
Crown shapes for different values of m and n
</p>
</div>
<!-- ![](media/image3.png){width="3.995833333333333in" -->
<!-- height="5.084027777777778in"} -->
<p>Now, we describe how leaves are distributed at any cross section of
the crown. Consider the upper portion of the crown (dark green portions
in Fig. 2). Assumption 1 implies that in a thin layer of crown between
heights <span class="math inline">\(z\)</span> and <span class="math inline">\(z + \Delta z\)</span>, the crown projection is
distributed (potentially with gaps) in an annulus of radius <span class="math inline">\(r(z)\)</span> and width <span class="math inline">\(\Delta r\)</span> (Fig. 3).</p>
<!-- ![](media/image5.png){width="3.920138888888889in" -->
<!-- height="2.223611111111111in"} -->
<p>The projected area of the crown within this layer therefore is</p>
<p><span class="math display">\[\Delta A_{\text{cp}}(z) = 2\pi r(z)
\cdot \Delta r \cdot \left( 1 - f_{\text{g}} \right)\]</span></p>
<p><span class="math display">\[= 2\pi r(z) \cdot (1 - f_{\text{g}})
\cdot \left| \frac{dr}{dz} \right|\Delta z = 2\pi\left( 1 - f_{\text{g}}
\right)r(z)\left| r^{'}(z) \right|\Delta z,\]</span></p>
<p>where <span class="math inline">\(f_{\text{g}}\)</span> is the
fraction of projected crown area in the upper canopy that is made of
gaps. These gaps will be filled by the crown in the lower canopy. If
<span class="math inline">\(f_{\text{g}} = 1\)</span>, there are no gaps
in the upper crown, and thus, no leaves in the lower crown. In real
trees, there is a small amount of leaf area in the lower crown, mostly
from young growing branches. A flat-top model typically used in
vegetation models can be recovered by setting <span class="math inline">\(n \rightarrow \infty\)</span> and <span class="math inline">\(f_{\text{g}} = 0\)</span>.</p>
<p>If the leaf area index in this layer is <span class="math inline">\(L(z)\)</span>, then the leaf area contained within
this layer is</p>
<p><span class="math display">\[\Delta A_{\text{l}} = L(z)\Delta
A_{\text{cp}}(z) = 2\pi\left( 1 - f_{\text{g}} \right)L(z)r(z)\left|
r^{'}(z) \right|\Delta z,\]</span></p>
<p>and the area of sapwood needed to supply water to the leaves in this
layer is</p>
<p><span class="math display">\[\Delta A_{\text{s}} =
\nu_{\text{H}}(z)L(z)\Delta A_{\text{cp}}(z) = 2\pi\left( 1 -
f_{\text{g}} \right)\nu_{\text{H}}(z)L(z)r(z)\left| r^{'}(z)
\right|\Delta z,\]</span></p>
<p>where <span class="math inline">\(\nu_{\text{H}}(z)\)</span> is the
Huber Value at height <span class="math inline">\(z\)</span>.</p>
<p>If the length of the pipes supplying water to the leaves in this
layer is <span class="math inline">\(l(z)\)</span>, the volume of those
pipes is</p>
<table class="table"><tbody><tr class="odd">
<td align="center">
<span class="math display">\[\Delta V_{\text{s}} =
l(z)\Delta A_{\text{s}}(z) = 2\pi\left( 1 - f_{\text{g}}
\right)\nu_{\text{H}}(z)L(z)r(z)\left| r^{'}(z) \right|l(z)\Delta
z\]</span> <span class="math inline">\(8\)</span>
</td>
</tr></tbody></table>
<hr>
<p>The total volume of pipes in the tree is obtained by integrating Eq.
(8) over the upper and lower canopy,</p>
<table class="table"><tbody>
<tr class="odd">
<td align="right"><span class="math display">\[{V_{\text{s}} =
V_{\text{sl}} + V_{\text{su}}}\\{= \int_{0}^{z_{\text{m}}}{2\pi
f_{\text{g}}\nu_{\text{H}}(z)L(z)r(z)r^{'}(z)l(z)dz -
\int_{z_{\text{m}}}^{H}{2\pi\left( 1 - f_{\text{g}}
\right)\nu_{\text{H}}(z)L(z)r(z)r^{'}(z)l(z)dz}},}\]</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(9\)</span></td>
</tr>
</tbody></table>
<hr>
<p>Note that the second (upper canopy) term has a negative sign because
<span class="math inline">\(r^{'}(z)\)</span> is negative in the
upper canopy.</p>
<p>To solve for <span class="math inline">\(V_{\text{s}}\)</span>, we
first evaluate the indefinite integral</p>
<table class="table"><tbody><tr class="odd">
<td align="center">
<span class="math display">\[I(z) =
\int_{}^{}{\nu_{\text{H}}(z)L(z)r(z)r^{'}(z)l(z)dz}.\]</span> <span class="math inline">\(10\)</span>
</td>
</tr></tbody></table>
<hr>
<p>To simplify this integral, we make two assumptions: 1) <span class="math inline">\(L(z)\)</span> and <span class="math inline">\(\nu_{\text{H}}(z)\)</span> do not vary within the
crown; and 2) the pipes carrying water to leaves in this layer first go
up vertically within the main stem, and then travel through branches
which are at an angle <span class="math inline">\(\theta\)</span> to the
main stem (Fig. XX). The length of the pipes is then</p>
<p><span class="math display">\[l(z) = z +
r\tan{(\theta/2)}.\]</span></p>
<p>Thus,</p>
<p><span class="math display">\[I = L\nu_{\text{H}}\int_{}^{}{\left( z +
r(z)\tan\left( \frac{\theta}{2} \right)
\right)r(z)r^{'}(z)dz}.\]</span></p>
<p>Using the identities <span class="math inline">\(dr =
r^{'}(z)dz\)</span> and <span class="math inline">\(\frac{1}{2}d\left( r^{2}(z) \right) =
r(z)r^{'}(z)dz\)</span>, we get</p>
<p><span class="math display">\[I = \ L\nu_{\text{H}}\left(
\frac{1}{2}\int_{}^{}{zd(r^{2})\ } + \tan\left( \frac{\theta}{2}
\right)\int_{}^{}{r^{2}(z)dr} \right).\]</span></p>
<p>Integrating the first term by parts (<span class="math inline">\(\int
udv = uv - \int vdu\)</span>, with <span class="math inline">\(u =
z\)</span> and <span class="math inline">\(v = r^{2}(z)\)</span>), we
get</p>
<table class="table"><tbody><tr class="odd">
<td align="center">
<span class="math display">\[I(z) =
\frac{1}{2}L\nu_{\text{H}}\ \left( zr^{2}(z) - \int_{}^{}{r^{2}(z)dz} +
2\tan\left( \frac{\theta}{2} \right)\frac{r^{3}(z)}{3} \right).\]</span>
<span class="math inline">\(11\)</span>
</td>
</tr></tbody></table>
<hr>
<p>Further,</p>
<table class="table"><tbody><tr class="odd">
<td align="center">
<span class="math display">\[\int r^{2}(z)dz =
r_{0}^{2}\int_{}^{}{q^{2}(z)dz} = Hr_{0}^{2}m^{2}n \cdot Β\left( \left(
\frac{z}{H} \right)^{n};2 - \frac{1}{n},\ 2m - 1 \right),\]</span> <span class="math inline">\(12\)</span>
</td>
</tr></tbody></table>
<hr>
<p>where <span class="math inline">\(Β(x;p,q)\)</span> is the
un-normalized incomplete Beta function evaluated at <span class="math inline">\(x\)</span>.</p>
<p>Now, let <span class="math inline">\(\alpha(z) = zr^{2}(z)\)</span>,
<span class="math inline">\(\beta(z) = \int r^{2}(z)dz\)</span>, and
<span class="math inline">\(\gamma(z) = 2\tan\left( \frac{\theta}{2}
\right)\frac{r^{3}(z)}{3}\)</span>. Then, <span class="math inline">\(I(z) = \frac{1}{2}L\nu_{\text{H}}\left( \alpha(z)
- \beta(z) + \gamma(z) \right)\)</span>, and <span class="math inline">\(\alpha(0) = \alpha(H) = 0\)</span>, <span class="math inline">\(\beta(0) = 0\)</span>, and <span class="math inline">\(\gamma(0) = \gamma(H) = 0\)</span>.</p>
<p>The integral in Eq. (11) is then</p>
<p><span class="math display">\[{V_{\text{s}} = 2\pi\left(
f_{\text{g}}\left( I\left( z_{\text{m}} \right) - I(0) \right) - \left(
1 - f_{\text{g}} \right)\left( I(H) - I\left( z_{\text{m}} \right)
\right) \right)
}\\{= \pi L\nu_{\text{H}}\left( \ \alpha\left( z_{\text{m}} \right) -
\beta\left( z_{\text{m}} \right) + \left( 1 - f_{\text{g}}
\right)\beta(H) + \gamma\left( z_{\text{m}} \right) \right)
}\\{= \pi L\nu_{\text{H}}\left( z_{\text{m}}r_{0}^{2}q_{\text{m}}^{2} -
Hr_{0}^{2}m^{2}n \cdot Β\left( \left( \frac{z_{\text{m}}}{H}
\right)^{n};2 - \frac{1}{n},\ 2m - 1 \right) + \left( 1 - f_{\text{g}}
\right)Hr_{0}^{2}m^{2}n \cdot Β\left( 1;2 - \frac{1}{n},\ 2m - 1 \right)
+ 2\tan\left( \frac{\theta}{2}
\right)\frac{r_{0}^{3}q_{\text{m}}^{3}}{3} \right)
}\\{= L\nu_{\text{H}}HA_{\text{c}}\left( \left( \frac{n - 1}{mn - 1}
\right)^{1/n} - \frac{m^{2}n}{q_{\text{m}}^{2}} \cdot Β\left( \frac{n -
1}{mn - 1};2 - \frac{1}{n},\ 2m - 1 \right) + \left( 1 - f_{\text{g}}
\right)\frac{m^{2}n}{q_{\text{m}}^{2}} \cdot Β\left( 1;2 - \frac{1}{n},\
2m - 1 \right) + 2\tan\left( \frac{\theta}{2}
\right)\frac{A_{\text{c}}^{1/2}}{3\sqrt{\pi}H} \right)}\]</span></p>
<p>Note that the first three terms are dependent on only <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span>, and can thus be precomputed (Fig. 4).
Denoting these by <span class="math inline">\(\eta_{c}(m,n)\)</span>,
and assuming the tilt angle of branches to be <span class="math inline">\(90^{\text{o}}\)</span>, we get</p>
<p><span class="math display">\[{V_{\text{s}} = \
L\nu_{\text{H}}HA_{\text{c}}\left( \eta_{c}(m,n) +
\frac{2}{3H}\sqrt{\frac{A_{\text{c}}}{\pi}} \right)
}\\{= A_{\text{s,base}}H\left( \eta_{c}(m,n) + \frac{2}{3H}r_{\text{c}}
\right).}\]</span></p>
<!-- ![Chart Description automatically -->
<!-- generated](media/image7.png){width="4.031573709536308in" -->
<!-- height="3.5040649606299215in"} -->
<div class="figure">
<img src="crown_geometry_files/figure-html/etac-1.png" alt="\label{fig:etac} eta_c as a function of m and n" width="432"><p class="caption">
eta_c as a function of m and n
</p>
</div>
<p>Fig. <span class="math inline">\(\eta_{c}(m,n)\)</span>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://jaideep777.github.io" class="external-link">Jaideep
Joshi</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
